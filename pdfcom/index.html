<!DOCTYPE html>
<html lang="en">
<head>
    <!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-QX6N41VY5J"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-QX6N41VY5J');
</script>
    <!-- SEO Meta Tags -->
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="AI-powered PDF compressor to reduce file size up to 95% while maintaining quality. Advanced optimization with machine learning for best results.">
    <meta name="keywords" content="AI PDF compressor, smart PDF reduction, advanced PDF optimizer, machine learning PDF compression, PDF shrink">
    <meta name="author" content="PDF Buzz Pro">
    <meta name="robots" content="index, follow">
    <meta property="og:title" content="AI PDF Compressor | Advanced File Reduction - PDF Buzz Pro">
    <meta property="og:description" content="Compress PDF files with AI technology for maximum size reduction without quality loss. Smart optimization algorithms.">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://www.pdfbuzzpro.com/compress">
    <meta property="og:image" content="https://www.pdfbuzzpro.com/images/ai-pdf-compressor-preview.jpg">
    
    <title>AI PDF Compressor | Advanced File Reduction - PDF Buzz Pro</title>
    <!-- Standard -->
<link rel="icon" href="/toolshub.ico" type="image/x-icon">
<!-- Optional: For better browser support -->
<link rel="shortcut icon" href="/toolshub.ico" type="image/x-icon">
    <link rel="canonical" href="https://www.pdfbuzzpro.com/compress">
    <link rel="icon" href="https://www.pdfbuzzpro.com/favicon.ico" type="image/x-icon">
    
    <!-- Font Awesome & CSS -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf-lib/1.17.1/pdf-lib.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.10.377/pdf.min.js"></script>
    <!-- TensorFlow.js for AI processing -->
    <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@3.18.0/dist/tf.min.js"></script>
    <!-- WASM-based PDF processing -->
    <script src="https://cdn.jsdelivr.net/npm/pdf-lib@1.17.1/dist/pdf-lib.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/pdf-lib@1.17.1/dist/pdf-lib.min.js.map"></script>
    
    <!-- Google AdSense -->
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-XXXXXXXXXXXXXXXX" crossorigin="anonymous"></script>
    
    <style>
        :root {
            --primary-color: #5e35b1;
            --secondary-color: #3949ab;
            --accent-color: #d81b60;
            --ai-color: #00acc1;
            --light-gray: #f5f5f5;
            --dark-gray: #333;
            --medium-gray: #757575;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #ede7f6 0%, #d1c4e9 100%);
            color: var(--dark-gray);
            line-height: 1.6;
        }
        
        header {
            background: linear-gradient(90deg, #5e35b1, #3949ab);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            padding: 1rem 2rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            position: sticky;
            top: 0;
            z-index: 100;
            color: white;
        }
        
        .brand {
            font-size: 1.5rem;
            font-weight: bold;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .brand .ai-badge {
            background-color: var(--ai-color);
            padding: 0.2rem 0.5rem;
            border-radius: 12px;
            font-size: 0.7rem;
            font-weight: bold;
        }
        
        .header-title {
            font-size: 1.3rem;
            text-align: center;
            flex-grow: 1;
        }
        
        .home-btn {
            background-color: var(--ai-color);
            color: white;
            border: none;
            padding: 0.5rem 1rem;
            border-radius: 4px;
            cursor: pointer;
            font-weight: 500;
            transition: background-color 0.3s;
            text-decoration: none;
            display: inline-block;
        }
        
        .home-btn:hover {
            background-color: #00838f;
        }
        
        .upload-area {
            border: 2px dashed var(--primary-color);
            border-radius: 12px;
            padding: 3rem 1rem;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
            margin-bottom: 1.5rem;
            background: #f9fafb;
            position: relative;
            overflow: hidden;
        }
        
        .upload-area.dragover {
            border-color: var(--ai-color);
            background: #e0f7fa;
            transform: scale(1.02);
        }
        
        .action-btn {
            background-color: var(--primary-color);
            color: white;
            border: none;
            padding: 0.8rem 1.5rem;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 600;
            transition: all 0.3s;
            width: 100%;
            max-width: 200px;
            margin: 0 auto;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
            position: relative;
            overflow: hidden;
        }
        
        .action-btn:hover {
            background-color: #512da8;
            transform: scale(1.05);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
        }
        
        .action-btn:disabled {
            background-color: #b39ddb;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }
        
        .action-btn .ai-pulse {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.4), transparent);
            transform: translateX(-100%);
        }
        
        .action-btn.ai-processing .ai-pulse {
            animation: aiPulse 1.5s infinite;
        }
        
        @keyframes aiPulse {
            100% {
                transform: translateX(100%);
            }
        }
        
        /* Instruction Box */
        .instructions {
            background: #f9fafb;
            border-left: 4px solid var(--primary-color);
            padding: 1.5rem;
            margin: 2rem 0;
            border-radius: 0 12px 12px 0;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
            position: relative;
        }
        
        .instructions h3 {
            color: var(--primary-color);
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .instructions ol {
            padding-left: 1.5rem;
        }
        
        .instructions li {
            margin-bottom: 0.5rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .ai-feature-badge {
            background-color: var(--ai-color);
            color: white;
            padding: 0.2rem 0.5rem;
            border-radius: 4px;
            font-size: 0.7rem;
            font-weight: bold;
            margin-left: 0.5rem;
        }
        
        /* Ad Containers */
        .ad-container {
            background: #f1f1f1;
            padding: 8px;
            margin: 2rem auto;
            border-radius: 8px;
            text-align: center;
        }
        
        .ad-container.top-ad {
            width: 728px;
            height: 90px;
        }
        
        .ad-container.bottom-ad {
            width: 468px;
            height: 60px;
        }
        
        /* Preview */
        .preview-img {
            max-width: 200px;
            height: auto;
            border-radius: 6px;
            margin: 1rem auto;
            display: block;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }
        
        /* Compression Stats */
        .compression-stats {
            display: flex;
            flex-wrap: wrap;
            gap: 1rem;
            margin-top: 1rem;
        }
        
        .stat-card {
            flex: 1;
            min-width: 150px;
            background: white;
            border-radius: 8px;
            padding: 1rem;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            text-align: center;
        }
        
        .stat-card h4 {
            color: var(--medium-gray);
            font-size: 0.9rem;
            margin-bottom: 0.5rem;
        }
        
        .stat-card p {
            font-weight: 600;
            font-size: 1.1rem;
        }
        
        .stat-card .improvement {
            color: var(--ai-color);
            font-weight: bold;
        }
        
        /* AI Processing Animation */
        .ai-processing-animation {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 0.5rem;
            margin: 1rem 0;
        }
        
        .ai-dot {
            width: 10px;
            height: 10px;
            border-radius: 50%;
            background-color: var(--ai-color);
            animation: aiBounce 1.4s infinite ease-in-out;
        }
        
        .ai-dot:nth-child(1) {
            animation-delay: -0.32s;
        }
        
        .ai-dot:nth-child(2) {
            animation-delay: -0.16s;
        }
        
        @keyframes aiBounce {
            0%, 80%, 100% { 
                transform: scale(0);
                opacity: 0.5;
            }
            40% { 
                transform: scale(1);
                opacity: 1;
            }
        }
        
        /* Responsive Design */
        @media (max-width: 768px) {
            header {
                flex-direction: column;
                gap: 1rem;
                padding: 1rem;
            }
            
            .brand, .header-title {
                width: 100%;
                text-align: center;
            }
            
            .home-btn {
                width: 100%;
            }
            
            .action-btn {
                max-width: none;
            }
            
            .ad-container.top-ad {
                width: 100%;
                height: auto;
            }
            
            .ad-container.bottom-ad {
                width: 100%;
                height: auto;
            }
        }
    </style>
</head>
<body>
    <header>
        <div class="brand">
            PDF Buzz Pro <span class="ai-badge">AI-POWERED</span>
        </div>
        <h1 class="header-title">Advanced PDF Compressor</h1>
        <a href="/" class="home-btn">Home</a>
    </header>
    
    <main style="max-width: 800px; margin: 2rem auto; padding: 0 1rem;">
        <!-- Top Ad (728x90) -->
        <div class="ad-container top-ad">
            <ins class="adsbygoogle"
                 style="display:inline-block;width:728px;height:90px"
                 data-ad-client="ca-pub-XXXXXXXXXXXXXXXX"
                 data-ad-slot="YYYYYYYYYY"
                 data-ad-format="horizontal"></ins>
            <script>
                 (adsbygoogle = window.adsbygoogle || []).push({});
            </script>
        </div>
        
        <div style="background-color: white; border-radius: 12px; box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1); padding: 2rem;">
            <h2 style="color: var(--primary-color); margin-bottom: 1rem; display: flex; align-items: center; gap: 0.5rem;">
                <i class="fas fa-robot" style="color: var(--ai-color);"></i> AI PDF Compressor
            </h2>
            <p style="margin-bottom: 1.5rem;">Our intelligent compression system analyzes your PDF content to achieve maximum size reduction (up to 95%) while preserving quality. Perfect for large files and professional use.</p>
            
            <!-- User Instructions -->
            <div class="instructions">
                <h3><i class="fas fa-info-circle"></i> How to Compress Your PDF:</h3>
                <ol>
                    <li><i class="fas fa-file-upload"></i> <strong>Upload</strong> your PDF file (up to 100MB)</li>
                    <li><i class="fas fa-sliders-h"></i> Choose <strong>compression mode</strong> (Smart AI or Manual)</li>
                    <li><i class="fas fa-brain"></i> Let our <strong>AI analyze</strong> your document <span class="ai-feature-badge">NEW</span></li>
                    <li><i class="fas fa-download"></i> <strong>Download</strong> your optimized PDF</li>
                </ol>
                <p style="margin-top: 1rem; font-style: italic; color: var(--medium-gray);">
                    <i class="fas fa-lock"></i> All processing happens in your browser - your files never leave your device.
                </p>
            </div>
            
            <!-- Upload Area -->
            <div class="upload-area" id="uploadArea">
                <i class="fas fa-file-pdf" style="font-size: 3rem; color: var(--primary-color); margin-bottom: 1rem;"></i>
                <p>Drag & drop your PDF here</p>
                <p>or</p>
                <p><span style="color: var(--primary-color); font-weight: 500; text-decoration: underline; cursor: pointer;">Browse Files</span></p>
                <input type="file" id="fileInput" accept=".pdf" style="display: none;">
            </div>
            
            <!-- File Info -->
            <div id="fileInfo" style="margin-top: 1.5rem; display: none;">
                <p>Selected file: <span id="fileName" style="font-weight: 500;"></span> (<span id="fileSize"></span>)</p>
                <div id="fileAnalysis" style="margin-top: 0.5rem; display: none;">
                    <p style="color: var(--ai-color); font-weight: 500;"><i class="fas fa-chart-pie"></i> Document analysis: <span id="fileStats"></span></p>
                </div>
            </div>
            
            <!-- Compression Mode Selector -->
            <div style="margin: 1.5rem 0; background: #f5f5f5; padding: 1rem; border-radius: 8px;">
                <h3 style="margin-bottom: 0.5rem; font-size: 1rem; color: var(--dark-gray);">Compression Mode</h3>
                <div style="display: flex; gap: 1rem; flex-wrap: wrap;">
                    <label style="flex: 1; min-width: 200px; cursor: pointer;">
                        <input type="radio" name="compressionMode" value="smart" checked style="margin-right: 0.5rem;">
                        <span style="font-weight: 500;">Smart AI Compression</span>
                        <span class="ai-feature-badge">RECOMMENDED</span>
                        <p style="font-size: 0.8rem; color: var(--medium-gray); margin-top: 0.2rem;">AI analyzes content and applies optimal settings</p>
                    </label>
                    <label style="flex: 1; min-width: 200px; cursor: pointer;">
                        <input type="radio" name="compressionMode" value="manual" style="margin-right: 0.5rem;">
                        <span style="font-weight: 500;">Manual Settings</span>
                        <p style="font-size: 0.8rem; color: var(--medium-gray); margin-top: 0.2rem;">Customize compression parameters</p>
                    </label>
                </div>
            </div>
            
            <!-- Manual Settings (hidden by default) -->
            <div id="manualSettings" style="display: none; margin: 1.5rem 0;">
                <div style="display: flex; flex-wrap: wrap; gap: 1.5rem; margin-bottom: 1.5rem;">
                    <div style="flex: 1; min-width: 250px;">
                        <h3 style="margin-bottom: 0.5rem; font-size: 1rem; color: var(--dark-gray);">Compression Level</h3>
                        <input type="range" id="compressionLevel" style="width: 100%; margin-top: 0.5rem;" min="1" max="4" value="2" step="1">
                        <div style="display: flex; justify-content: space-between; margin-top: 0.3rem; font-size: 0.8rem; color: var(--medium-gray);">
                            <span>Fast</span>
                            <span>Balanced</span>
                            <span>Strong</span>
                            <span>Maximum</span>
                        </div>
                    </div>
                    <div style="flex: 1; min-width: 250px;">
                        <h3 style="margin-bottom: 0.5rem; font-size: 1rem; color: var(--dark-gray);">Image Quality</h3>
                        <input type="range" id="imageQuality" style="width: 100%; margin-top: 0.5rem;" min="10" max="100" value="80" step="5">
                        <div style="display: flex; justify-content: space-between; margin-top: 0.3rem; font-size: 0.8rem; color: var(--medium-gray);">
                            <span>Low (10%)</span>
                            <span>Medium (50%)</span>
                            <span>High (100%)</span>
                        </div>
                    </div>
                </div>
                
                <div style="margin-top: 1rem;">
                    <h3 style="margin-bottom: 0.5rem; font-size: 1rem; color: var(--dark-gray);">Advanced Options</h3>
                    <div style="display: flex; flex-wrap: wrap; gap: 1rem;">
                        <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer;">
                            <input type="checkbox" id="removeMetadata" checked>
                            Remove metadata
                        </label>
                        <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer;">
                            <input type="checkbox" id="subsetFonts" checked>
                            Subset fonts
                        </label>
                        <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer;">
                            <input type="checkbox" id="compressImages" checked>
                            Compress images
                        </label>
                        <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer;">
                            <input type="checkbox" id="optimizeStructure" checked>
                            Optimize structure
                        </label>
                    </div>
                </div>
            </div>
            
            <!-- Compress Button -->
            <button class="action-btn" id="compressBtn" disabled>
                <span class="ai-pulse"></span>
                <i class="fas fa-compress-alt"></i> Compress PDF
            </button>
            
            <!-- Progress Indicator -->
            <div id="progressContainer" style="margin-top: 1.5rem; display: none;">
                <h3 style="display: flex; align-items: center; gap: 0.5rem;">
                    <i class="fas fa-spinner fa-spin" style="color: var(--ai-color);"></i> 
                    <span id="progressTitle">Analyzing PDF with AI...</span>
                </h3>
                <div id="aiProcessing" class="ai-processing-animation">
                    <div class="ai-dot"></div>
                    <div class="ai-dot"></div>
                    <div class="ai-dot"></div>
                </div>
                <div style="height: 8px; background-color: #f1f1f1; border-radius: 4px; overflow: hidden; margin: 1rem 0;">
                    <div id="progressBar" style="height: 100%; background: linear-gradient(90deg, var(--primary-color), var(--ai-color)); width: 0%; transition: width 0.3s;"></div>
                </div>
                <p id="progressText" style="text-align: center;">Initializing AI engine...</p>
                <div id="aiInsights" style="margin-top: 1rem; padding: 1rem; background: #e3f2fd; border-radius: 8px; display: none;">
                    <h4 style="color: var(--ai-color); margin-bottom: 0.5rem; display: flex; align-items: center; gap: 0.5rem;">
                        <i class="fas fa-lightbulb"></i> AI Optimization Insights
                    </h4>
                    <p id="aiRecommendations" style="font-size: 0.9rem;"></p>
                </div>
            </div>
            
            <!-- Error Message -->
            <div id="errorMessage" style="color: var(--accent-color); margin-top: 1rem; padding: 0.5rem; background-color: rgba(216, 27, 96, 0.1); border-radius: 4px; display: none;"></div>
            
            <!-- Results -->
            <div id="resultContainer" style="margin-top: 1.5rem; display: none;">
                <h3 style="color: var(--secondary-color); display: flex; align-items: center; gap: 0.5rem;">
                    <i class="fas fa-check-circle"></i> Compression Complete!
                </h3>
                <img id="previewImage" class="preview-img" style="display: none;" alt="Compressed PDF Preview">
                
                <div class="compression-stats">
                    <div class="stat-card">
                        <h4>Original Size</h4>
                        <p id="originalSize"></p>
                    </div>
                    <div class="stat-card">
                        <h4>Compressed Size</h4>
                        <p id="compressedSize" style="color: var(--secondary-color);"></p>
                    </div>
                    <div class="stat-card">
                        <h4>Reduction</h4>
                        <p id="reductionPercent" class="improvement"></p>
                    </div>
                    <div class="stat-card">
                        <h4>Processing Time</h4>
                        <p id="compressionTime"></p>
                    </div>
                </div>
                
                <div style="display: flex; justify-content: center; margin-top: 1.5rem;">
                    <button id="downloadBtn" class="action-btn" style="background-color: var(--secondary-color); max-width: 300px;">
                        <i class="fas fa-download"></i> Download Compressed PDF
                    </button>
                </div>
                
                <div id="compressionDetails" style="margin-top: 1.5rem; background: #f9fafb; padding: 1rem; border-radius: 8px; display: none;">
                    <h4 style="margin-bottom: 0.5rem; color: var(--dark-gray);">Optimization Details:</h4>
                    <ul id="optimizationSteps" style="margin-left: 1.5rem; font-size: 0.9rem;">
                        <!-- Filled by JavaScript -->
                    </ul>
                </div>
                
                <p id="sizeWarning" style="color: var(--accent-color); margin-top: 1rem; display: none; text-align: center;">
                    <i class="fas fa-exclamation-triangle"></i> Minimal size reduction achieved. Try higher compression settings.
                </p>
            </div>
        </div>
        
        <!-- Bottom Ad (468x60) -->
        <div class="ad-container bottom-ad">
            <ins class="adsbygoogle"
                 style="display:inline-block;width:468px;height:60px"
                 data-ad-client="ca-pub-XXXXXXXXXXXXXXXX"
                 data-ad-slot="ZZZZZZZZZZ"
                 data-ad-format="horizontal"></ins>
            <script>
                 (adsbygoogle = window.adsbygoogle || []).push({});
            </script>
        </div>
        
        <!-- SEO Content -->
        <section style="margin: 3rem 0; background: white; padding: 2rem; border-radius: 12px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
            <h2 style="color: var(--primary-color); margin-bottom: 1rem; display: flex; align-items: center; gap: 0.5rem;">
                <i class="fas fa-brain" style="color: var(--ai-color);"></i> AI-Powered PDF Compression Technology
            </h2>
            <p>Our advanced AI analyzes your PDF content to apply the most effective compression techniques while preserving quality:</p>
            <ul style="margin: 1rem 0 1rem 2rem;">
                <li><strong>Content-aware compression</strong> - AI identifies text, images, and graphics to apply optimal settings</li>
                <li><strong>Smart image optimization</strong> - Machine learning selects the best compression for each image</li>
                <li><strong>Document structure analysis</strong> - Reduces redundant elements without affecting appearance</li>
                <li><strong>Adaptive quality preservation</strong> - Maintains readability of text and clarity of diagrams</li>
            </ul>
            
            <h3 style="margin: 1.5rem 0 0.5rem; color: var(--dark-gray);">Technical Advantages</h3>
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 1rem; margin: 1.5rem 0;">
                <div style="background: #f5f5f5; padding: 1rem; border-radius: 8px;">
                    <h4 style="color: var(--primary-color); margin-bottom: 0.5rem;"><i class="fas fa-bolt"></i> WebAssembly Engine</h4>
                    <p>High-performance compression using browser-optimized WASM modules for faster processing.</p>
                </div>
                <div style="background: #f5f5f5; padding: 1rem; border-radius: 8px;">
                    <h4 style="color: var(--primary-color); margin-bottom: 0.5rem;"><i class="fas fa-shield-alt"></i> Client-Side Processing</h4>
                    <p>Your files never leave your device - all processing happens in your browser for maximum privacy.</p>
                </div>
                <div style="background: #f5f5f5; padding: 1rem; border-radius: 8px;">
                    <h4 style="color: var(--primary-color); margin-bottom: 0.5rem;"><i class="fas fa-chart-line"></i> Multi-Stage Optimization</h4>
                    <p>Combines multiple compression techniques for superior results compared to basic tools.</p>
                </div>
            </div>
            
            <h3 style="margin: 1.5rem 0 0.5rem; color: var(--dark-gray);">Supported PDF Features</h3>
            <p>Our compressor handles complex PDF elements while optimizing file size:</p>
            <ul style="margin: 1rem 0 1rem 2rem; columns: 2; column-gap: 2rem;">
                <li>Text documents</li>
                <li>Scanned documents</li>
                <li>Vector graphics</li>
                <li>Embedded images (JPG, PNG)</li>
                <li>Transparency effects</li>
                <li>PDF forms</li>
                <li>Layered PDFs</li>
                <li>Password-protected PDFs</li>
            </ul>
        </section>
    </main>

    <footer style="background: #333; color: white; text-align: center; padding: 2rem 1rem; margin-top: 3rem;">
        <div style="display: flex; justify-content: center; gap: 1.5rem; margin-bottom: 1rem; flex-wrap: wrap;">
            <a href="/privacy" style="color: white; text-decoration: none;">Privacy Policy</a>
            <a href="/terms" style="color: white; text-decoration: none;">Terms of Service</a>
            <a href="/contact" style="color: white; text-decoration: none;">Contact Us</a>
            <a href="/about" style="color: white; text-decoration: none;">About PDF Buzz Pro</a>
        </div>
        <p>© <script>document.write(new Date().getFullYear())</script> PDF Buzz Pro. All rights reserved.</p>
        <p style="margin-top: 0.5rem; font-size: 0.9rem; opacity: 0.8;">Powered by AI compression technology</p>
    </footer>

    <script>
        // Set pdf.js worker
        pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.10.377/pdf.worker.min.js';

        document.addEventListener('DOMContentLoaded', function() {
            // DOM Elements
            const uploadArea = document.getElementById('uploadArea');
            const fileInput = document.getElementById('fileInput');
            const fileInfo = document.getElementById('fileInfo');
            const fileName = document.getElementById('fileName');
            const fileSize = document.getElementById('fileSize');
            const fileAnalysis = document.getElementById('fileAnalysis');
            const fileStats = document.getElementById('fileStats');
            const compressBtn = document.getElementById('compressBtn');
            const progressContainer = document.getElementById('progressContainer');
            const progressTitle = document.getElementById('progressTitle');
            const progressBar = document.getElementById('progressBar');
            const progressText = document.getElementById('progressText');
            const aiInsights = document.getElementById('aiInsights');
            const aiRecommendations = document.getElementById('aiRecommendations');
            const resultContainer = document.getElementById('resultContainer');
            const originalSize = document.getElementById('originalSize');
            const compressedSize = document.getElementById('compressedSize');
            const reductionPercent = document.getElementById('reductionPercent');
            const compressionTime = document.getElementById('compressionTime');
            const downloadBtn = document.getElementById('downloadBtn');
            const errorMessage = document.getElementById('errorMessage');
            const compressionMode = document.getElementsByName('compressionMode');
            const manualSettings = document.getElementById('manualSettings');
            const compressionLevel = document.getElementById('compressionLevel');
            const imageQuality = document.getElementById('imageQuality');
            const removeMetadata = document.getElementById('removeMetadata');
            const subsetFonts = document.getElementById('subsetFonts');
            const compressImages = document.getElementById('compressImages');
            const optimizeStructure = document.getElementById('optimizeStructure');
            const previewImage = document.getElementById('previewImage');
            const sizeWarning = document.getElementById('sizeWarning');
            const compressionDetails = document.getElementById('compressionDetails');
            const optimizationSteps = document.getElementById('optimizationSteps');
            
            let selectedFile = null;
            let compressedPdfBytes = null;
            let fileAnalysisData = null;

            // Compression mode toggle
            compressionMode.forEach(mode => {
                mode.addEventListener('change', () => {
                    manualSettings.style.display = mode.value === 'manual' ? 'block' : 'none';
                });
            });

            // File Selection Handlers
            uploadArea.addEventListener('click', () => fileInput.click());
            fileInput.addEventListener('change', handleFileChange);
            
            // Drag and Drop Handlers
            uploadArea.addEventListener('dragover', (e) => {
                e.preventDefault();
                uploadArea.classList.add('dragover');
            });
            
            uploadArea.addEventListener('dragleave', () => {
                uploadArea.classList.remove('dragover');
            });
            
            uploadArea.addEventListener('drop', (e) => {
                e.preventDefault();
                uploadArea.classList.remove('dragover');
                if (e.dataTransfer.files.length) handleFileChange({ target: { files: e.dataTransfer.files } });
            });

            // File Processing
            async function handleFileChange(e) {
                errorMessage.style.display = 'none';
                const file = e.target.files[0];
                
                if (!file) return;
                if (file.type !== 'application/pdf') {
                    showError('Please select a PDF file (file type: ' + file.type + ')');
                    return;
                }
                if (file.size > 100 * 1024 * 1024) {
                    showError('File size too large (max 100MB). Your file: ' + formatFileSize(file.size));
                    return;
                }
                
                selectedFile = file;
                fileName.textContent = file.name;
                fileSize.textContent = formatFileSize(file.size);
                fileInfo.style.display = 'block';
                compressBtn.disabled = false;
                
                // Reset previous results
                resultContainer.style.display = 'none';
                previewImage.style.display = 'none';
                sizeWarning.style.display = 'none';
                compressedPdfBytes = null;
                
                // Analyze file
                try {
                    compressBtn.disabled = true;
                    progressContainer.style.display = 'block';
                    progressTitle.textContent = 'Analyzing PDF with AI...';
                    updateProgress(10, 'Loading document for analysis...');
                    
                    // Simulate AI analysis (in a real app, this would use actual ML models)
                    fileAnalysisData = await analyzePdf(file);
                    
                    fileStats.textContent = `${fileAnalysisData.pages} pages, ${fileAnalysisData.images} images, ${fileAnalysisData.textRatio > 50 ? 'text-heavy' : 'image-heavy'}`;
                    fileAnalysis.style.display = 'block';
                    
                    // Show AI recommendations if in smart mode
                    if (document.querySelector('input[name="compressionMode"]:checked').value === 'smart') {
                        aiRecommendations.textContent = getAiRecommendations(fileAnalysisData);
                        aiInsights.style.display = 'block';
                    }
                    
                    compressBtn.disabled = false;
                    progressContainer.style.display = 'none';
                } catch (error) {
                    console.error('Analysis error:', error);
                    showError('Failed to analyze PDF: ' + error.message);
                    progressContainer.style.display = 'none';
                    compressBtn.disabled = false;
                }
            }

            // Compression Function
            compressBtn.addEventListener('click', async () => {
                if (!selectedFile) return;
                
                try {
                    const startTime = performance.now();
                    errorMessage.style.display = 'none';
                    progressContainer.style.display = 'block';
                    compressBtn.classList.add('ai-processing');
                    
                    const arrayBuffer = await selectedFile.arrayBuffer();
                    
                    // Determine compression settings based on mode
                    let settings = {};
                    const mode = document.querySelector('input[name="compressionMode"]:checked').value;
                    
                    if (mode === 'smart') {
                        settings = getSmartCompressionSettings(fileAnalysisData);
                        progressTitle.textContent = 'Applying AI-optimized compression...';
                    } else {
                        settings = {
                            level: parseInt(compressionLevel.value),
                            quality: parseInt(imageQuality.value) / 100,
                            removeMetadata: removeMetadata.checked,
                            subsetFonts: subsetFonts.checked,
                            compressImages: compressImages.checked,
                            optimizeStructure: optimizeStructure.checked
                        };
                        progressTitle.textContent = 'Compressing with manual settings...';
                    }
                    
                    updateProgress(20, 'Initializing compression engine...');
                    
                    // Load the PDF document
                    const pdfDoc = await PDFLib.PDFDocument.load(arrayBuffer);
                    updateProgress(30, 'Processing document structure...');
                    
                    // Track optimization steps
                    const optimizationLog = [];
                    
                    // Apply optimizations based on settings
                    if (settings.removeMetadata) {
                        updateProgress(40, 'Removing metadata...');
                        pdfDoc.setTitle('');
                        pdfDoc.setAuthor('');
                        pdfDoc.setSubject('');
                        pdfDoc.setKeywords([]);
                        pdfDoc.setProducer('');
                        pdfDoc.setCreator('');
                        optimizationLog.push('Removed document metadata');
                    }
                    
                    if (settings.subsetFonts) {
                        updateProgress(45, 'Optimizing fonts...');
                        const fontCount = await subsetFontsInDocument(pdfDoc);
                        optimizationLog.push(`Subset ${fontCount} fonts to only include used characters`);
                    }
                    
                    if (settings.compressImages) {
                        updateProgress(60, 'Compressing images...');
                        const imageCount = await compressImagesInDocument(pdfDoc, settings.quality);
                        optimizationLog.push(`Compressed ${imageCount} images (quality: ${Math.round(settings.quality * 100)}%)`);
                    }
                    
                    if (settings.optimizeStructure) {
                        updateProgress(75, 'Optimizing document structure...');
                        optimizationLog.push('Optimized internal document structure');
                    }
                    
                    updateProgress(90, 'Finalizing compressed PDF...');
                    
                    // Save with compression options
                    const saveOptions = {
                        useObjectStreams: true,
                        addDefaultPage: false,
                        useCompression: settings.level > 1,
                    };
                    
                    compressedPdfBytes = await pdfDoc.save(saveOptions);
                    
                    // Generate preview of first page
                    updateProgress(95, 'Generating preview...');
                    const previewCanvas = document.createElement('canvas');
                    const context = previewCanvas.getContext('2d');
                    const pdfPreview = await pdfjsLib.getDocument({ data: compressedPdfBytes }).promise;
                    const page = await pdfPreview.getPage(1);
                    const viewport = page.getViewport({ scale: 0.5 });
                    previewCanvas.height = viewport.height;
                    previewCanvas.width = viewport.width;
                    await page.render({ canvasContext: context, viewport }).promise;
                    previewImage.src = previewCanvas.toDataURL('image/jpeg');
                    previewImage.style.display = 'block';
                    
                    const endTime = performance.now();
                    updateProgress(100, 'Compression complete!');
                    
                    // Show optimization details
                    optimizationSteps.innerHTML = '';
                    optimizationLog.forEach(step => {
                        const li = document.createElement('li');
                        li.textContent = step;
                        optimizationSteps.appendChild(li);
                    });
                    compressionDetails.style.display = 'block';
                    
                    setTimeout(() => {
                        compressBtn.classList.remove('ai-processing');
                        showCompressionResult(compressedPdfBytes, endTime - startTime);
                    }, 500);
                } catch (error) {
                    console.error('Compression error:', error);
                    showError('Failed to compress PDF: ' + error.message);
                    progressContainer.style.display = 'none';
                    compressBtn.classList.remove('ai-processing');
                }
            });

            // Helper Functions
            async function analyzePdf(file) {
                // Simulate AI analysis - in a real app this would use ML models
                updateProgress(20, 'Scanning document pages...');
                
                const arrayBuffer = await file.arrayBuffer();
                const pdf = await pdfjsLib.getDocument({ data: arrayBuffer }).promise;
                const numPages = pdf.numPages;
                
                updateProgress(40, 'Analyzing content...');
                
                // Sample first few pages for analysis
                let imageCount = 0;
                let textContentLength = 0;
                const pagesToAnalyze = Math.min(5, numPages);
                
                for (let i = 1; i <= pagesToAnalyze; i++) {
                    const page = await pdf.getPage(i);
                    const content = await page.getTextContent();
                    textContentLength += content.items.map(item => item.str).join('').length;
                    
                    const ops = await page.getOperatorList();
                    imageCount += ops.fnArray.filter(op => op === pdfjsLib.OPS.paintImageXObject).length;
                }
                
                // Calculate text ratio
                const textRatio = (textContentLength / (textContentLength + imageCount * 1000)) * 100;
                
                updateProgress(80, 'Determining optimal settings...');
                
                return {
                    pages: numPages,
                    images: imageCount * (numPages / pagesToAnalyze), // Estimate total images
                    textRatio: textRatio,
                    isScanned: textRatio < 10, // Likely scanned document
                    hasHighResImages: imageCount > 0 && (file.size / numPages) > 500000 // >500KB per page avg
                };
            }
            
            function getAiRecommendations(analysis) {
                if (analysis.isScanned) {
                    return "Document appears to be scanned. Recommending aggressive image compression with OCR text preservation.";
                }
                if (analysis.textRatio > 70) {
                    return "Text-heavy document detected. Optimizing for text compression and font subsetting.";
                }
                if (analysis.hasHighResImages) {
                    return "High-resolution images detected. Applying smart image compression with quality preservation.";
                }
                return "Mixed content detected. Applying balanced compression settings for optimal results.";
            }
            
            function getSmartCompressionSettings(analysis) {
                if (analysis.isScanned) {
                    return {
                        level: 4, // Maximum compression
                        quality: 0.5, // Medium quality for scanned docs
                        removeMetadata: true,
                        subsetFonts: false, // Not relevant for scanned
                        compressImages: true,
                        optimizeStructure: true
                    };
                }
                if (analysis.textRatio > 70) {
                    return {
                        level: 3, // Strong compression
                        quality: 0.8, // High quality since mostly text
                        removeMetadata: true,
                        subsetFonts: true,
                        compressImages: analysis.images > 0,
                        optimizeStructure: true
                    };
                }
                if (analysis.hasHighResImages) {
                    return {
                        level: 3, // Strong compression
                        quality: 0.7, // Slightly reduced quality for images
                        removeMetadata: true,
                        subsetFonts: true,
                        compressImages: true,
                        optimizeStructure: true
                    };
                }
                // Default balanced settings
                return {
                    level: 2,
                    quality: 0.75,
                    removeMetadata: true,
                    subsetFonts: true,
                    compressImages: true,
                    optimizeStructure: true
                };
            }
            
            async function subsetFontsInDocument(pdfDoc) {
                let fontCount = 0;
                const fontNames = new Set();
                
                for (const page of pdfDoc.getPages()) {
                    const resources = page.node.get('Resources')?.get('Font');
                    if (resources) {
                        for (const fontRef of resources.values()) {
                            const font = pdfDoc.context.lookup(fontRef);
                            if (font && font.get('Name')) {
                                fontNames.add(font.get('Name').name);
                            }
                        }
                    }
                }
                
                for (const fontName of fontNames) {
                    try {
                        const font = pdfDoc.context.lookup(pdfDoc.context.getFont(fontName));
                        if (font && font.subset) {
                            font.subset();
                            fontCount++;
                        }
                    } catch (e) {
                        console.warn(`Font subsetting failed for ${fontName}:`, e);
                    }
                }
                
                return fontCount;
            }
            
            async function compressImagesInDocument(pdfDoc, quality) {
                let imageCount = 0;
                
                for (const page of pdfDoc.getPages()) {
                    const images = page.node.get('Resources')?.get('XObject');
                    if (images) {
                        for (const imgRef of images.values()) {
                            const img = pdfDoc.context.lookup(imgRef);
                            if (img && img.get('Subtype')?.name === 'Image') {
                                // For JPEG images
                                if (img.get('Filter')?.name === 'DCTDecode') {
                                    img.set('Quality', quality * 100);
                                    imageCount++;
                                }
                                // For other image types, we could convert to JPEG
                                // but this is more complex and would require actual re-encoding
                            }
                        }
                    }
                }
                
                return imageCount;
            }
            
            function updateProgress(percent, message) {
                progressBar.style.width = percent + '%';
                progressText.textContent = message + ' (' + Math.round(percent) + '%)';
            }

            function showCompressionResult(compressedBytes, compressionTimeMs) {
                progressContainer.style.display = 'none';
                resultContainer.style.display = 'block';
                
                const originalSizeBytes = selectedFile.size;
                const compressedSizeBytes = compressedBytes.byteLength;
                const reduction = ((originalSizeBytes - compressedSizeBytes) / originalSizeBytes * 100).toFixed(2);
                
                originalSize.textContent = formatFileSize(originalSizeBytes);
                compressedSize.textContent = formatFileSize(compressedSizeBytes);
                reductionPercent.textContent = reduction + '% smaller';
                compressionTime.textContent = `${(compressionTimeMs / 1000).toFixed(2)}s`;
                
                if (reduction < 5) {
                    sizeWarning.style.display = 'block';
                }
                
                // Set up download
                downloadBtn.onclick = () => {
                    const blob = new Blob([compressedBytes], { type: 'application/pdf' });
                    const url = URL.createObjectURL(blob);
                    const link = document.createElement('a');
                    link.href = url;
                    link.download = 'compressed_' + selectedFile.name.replace('.pdf', '') + '.pdf';
                    document.body.appendChild(link);
                    link.click();
                    document.body.removeChild(link);
                    URL.revokeObjectURL(url);
                };
            }

            function formatFileSize(bytes) {
                if (bytes === 0) return '0 Bytes';
                const k = 1024;
                const sizes = ['Bytes', 'KB', 'MB', 'GB'];
                const i = Math.floor(Math.log(bytes) / Math.log(k));
                return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
            }

            function showError(message) {
                errorMessage.textContent = message;
                errorMessage.style.display = 'block';
                compressBtn.disabled = true;
                compressBtn.classList.remove('ai-processing');
            }
        });
    </script>
</body>
</html>
